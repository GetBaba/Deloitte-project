{"cells":[{"cell_type":"code","execution_count":1,"id":"9e454d24","metadata":{"id":"9e454d24","executionInfo":{"status":"ok","timestamp":1720537048286,"user_tz":-120,"elapsed":2628,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import plotly.express as px\n","from datetime import datetime, timedelta\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import math\n","from google.colab import drive\n","import os\n","\n"]},{"cell_type":"markdown","id":"b41e8534","metadata":{"id":"b41e8534"},"source":["## Data Cleaning - Customer_info"]},{"cell_type":"markdown","source":["#### Reading Data"],"metadata":{"id":"ZXwBD3o1pXv5"},"id":"ZXwBD3o1pXv5"},{"cell_type":"code","execution_count":2,"id":"41e662f0","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"id":"41e662f0","executionInfo":{"status":"ok","timestamp":1720537072683,"user_tz":-120,"elapsed":24402,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"03e255b7-39c8-4bd2-ab31-86a0640b01a2"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]},{"output_type":"execute_result","data":{"text/plain":["    Distance        City Store.Size        Opening.Hours Phone.Number  \\\n","0  35.820157      Burgos     362821    1:00 PM - 1:00 AM    941096462   \n","1   31.68167  A  CoruÃ±a       1315   11:00 PM - 6:00 AM    943541778   \n","2  29.656813      Bilbao        766    1:00 PM - 1:00 AM    957692923   \n","3  31.277988    Alicante        815  11:00 AM - 11:00 PM    932749967   \n","4  38.071841      Madrid       2317   6:00 AM - 11:00 PM    933103025   \n","\n","  Free.Wifi Parking                                        Description  \\\n","0         1       0  Vibrant hues of turquoise and red adorn the ex...   \n","1         1       0  Warm wooden accents, rich Guinness aromas, and...   \n","2         1       1  Warmly lit, rustic tables and vintage amphorae...   \n","3         1       0  Vibrant eatery serving a medley of small plate...   \n","4         1       1  Luxurious haven where luck and indulgence conv...   \n","\n","  Zip.Code   Latitude  Longitude Date.Opening   ID  \\\n","0     9000  42.352143  -3.677571   2019-07-10  1.0   \n","1    15000  43.351256  -8.410301   2020-02-17  2.0   \n","2    48000  43.255756  -2.939133   2019-04-15  3.0   \n","3     3000  38.354208  -0.505718   2019-04-17  4.0   \n","4    28000  40.463496  -3.635538   2019-04-05  5.0   \n","\n","   sales representative latitude  sales representative longitude  \\\n","0                      42.330026                       -3.719371   \n","1                      43.362927                       -8.402358   \n","2                      43.262941                       -2.935849   \n","3                      38.300530                       -0.604413   \n","4                      40.453918                       -3.654711   \n","\n","   Sales Representative ID  \n","0                       25  \n","1                       22  \n","2                       10  \n","3                       15  \n","4                       29  "],"text/html":["\n","  <div id=\"df-f6f30275-e757-4997-b368-df49ad938f1e\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Distance</th>\n","      <th>City</th>\n","      <th>Store.Size</th>\n","      <th>Opening.Hours</th>\n","      <th>Phone.Number</th>\n","      <th>Free.Wifi</th>\n","      <th>Parking</th>\n","      <th>Description</th>\n","      <th>Zip.Code</th>\n","      <th>Latitude</th>\n","      <th>Longitude</th>\n","      <th>Date.Opening</th>\n","      <th>ID</th>\n","      <th>sales representative latitude</th>\n","      <th>sales representative longitude</th>\n","      <th>Sales Representative ID</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>35.820157</td>\n","      <td>Burgos</td>\n","      <td>362821</td>\n","      <td>1:00 PM - 1:00 AM</td>\n","      <td>941096462</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Vibrant hues of turquoise and red adorn the ex...</td>\n","      <td>9000</td>\n","      <td>42.352143</td>\n","      <td>-3.677571</td>\n","      <td>2019-07-10</td>\n","      <td>1.0</td>\n","      <td>42.330026</td>\n","      <td>-3.719371</td>\n","      <td>25</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>31.68167</td>\n","      <td>A  CoruÃ±a</td>\n","      <td>1315</td>\n","      <td>11:00 PM - 6:00 AM</td>\n","      <td>943541778</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Warm wooden accents, rich Guinness aromas, and...</td>\n","      <td>15000</td>\n","      <td>43.351256</td>\n","      <td>-8.410301</td>\n","      <td>2020-02-17</td>\n","      <td>2.0</td>\n","      <td>43.362927</td>\n","      <td>-8.402358</td>\n","      <td>22</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>29.656813</td>\n","      <td>Bilbao</td>\n","      <td>766</td>\n","      <td>1:00 PM - 1:00 AM</td>\n","      <td>957692923</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Warmly lit, rustic tables and vintage amphorae...</td>\n","      <td>48000</td>\n","      <td>43.255756</td>\n","      <td>-2.939133</td>\n","      <td>2019-04-15</td>\n","      <td>3.0</td>\n","      <td>43.262941</td>\n","      <td>-2.935849</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>31.277988</td>\n","      <td>Alicante</td>\n","      <td>815</td>\n","      <td>11:00 AM - 11:00 PM</td>\n","      <td>932749967</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Vibrant eatery serving a medley of small plate...</td>\n","      <td>3000</td>\n","      <td>38.354208</td>\n","      <td>-0.505718</td>\n","      <td>2019-04-17</td>\n","      <td>4.0</td>\n","      <td>38.300530</td>\n","      <td>-0.604413</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>38.071841</td>\n","      <td>Madrid</td>\n","      <td>2317</td>\n","      <td>6:00 AM - 11:00 PM</td>\n","      <td>933103025</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Luxurious haven where luck and indulgence conv...</td>\n","      <td>28000</td>\n","      <td>40.463496</td>\n","      <td>-3.635538</td>\n","      <td>2019-04-05</td>\n","      <td>5.0</td>\n","      <td>40.453918</td>\n","      <td>-3.654711</td>\n","      <td>29</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f6f30275-e757-4997-b368-df49ad938f1e')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-f6f30275-e757-4997-b368-df49ad938f1e button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-f6f30275-e757-4997-b368-df49ad938f1e');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-3f93be97-3c26-4ea3-87a7-b32f7cedd82f\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-3f93be97-3c26-4ea3-87a7-b32f7cedd82f')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-3f93be97-3c26-4ea3-87a7-b32f7cedd82f button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"customer_info","summary":"{\n  \"name\": \"customer_info\",\n  \"rows\": 9663,\n  \"fields\": [\n    {\n      \"column\": \"Distance\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 9658,\n        \"samples\": [\n          34.8578587713407,\n          30.0067504121969,\n          36.0876870421201\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"City\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 20,\n        \"samples\": [\n          \"Burgos\",\n          \"Sevilla \",\n          \"Balencia\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Store.Size\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3286,\n        \"samples\": [\n          1801,\n          3203,\n          1370\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Opening.Hours\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 10,\n        \"samples\": [\n          \"noon - midnight\",\n          \"11:00 PM - 6:00 AM\",\n          \"1:00 PM - 2:00 AM\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Phone.Number\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 9658,\n        \"samples\": [\n          939710331,\n          926549237,\n          928351416\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Free.Wifi\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          0,\n          \"no\",\n          \"yes\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Parking\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 6,\n        \"samples\": [\n          0,\n          1,\n          -1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Description\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 43,\n        \"samples\": [\n          \"A lively gathering spot where craft beers and expertly mixed cocktails flow freely amidst warm ambiance and lively chatter.\",\n          \"Vibrant tapas bar serving authentic paella and empanadas in a cozy, rustic-chic setting with warm aromas of olive oil and saffron.\",\n          \"Warm lighting illuminates the cozy atmosphere of the Japanese restaurant, where subtle aromas of soy sauce and sesame oil mingle with the soft hum of conversation.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Zip.Code\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 16,\n        \"samples\": [\n          9000,\n          15000,\n          10000\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Latitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2.108996876813005,\n        \"min\": -8.42757029992523,\n        \"max\": 43.3850328168555,\n        \"num_unique_values\": 9659,\n        \"samples\": [\n          39.0933416188348,\n          40.3990115623367,\n          37.3843919499563\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Longitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3.3357664395308384,\n        \"min\": -75.34948,\n        \"max\": 43.36763,\n        \"num_unique_values\": 9659,\n        \"samples\": [\n          -0.603109875357096,\n          -3.69741939043526,\n          -5.95793400067316\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Date.Opening\",\n      \"properties\": {\n        \"dtype\": \"date\",\n        \"min\": \"2016-09-28 00:00:00\",\n        \"max\": \"2022-05-17 00:00:00\",\n        \"num_unique_values\": 1347,\n        \"samples\": [\n          \"2018-02-10 00:00:00\",\n          \"2017-08-17 00:00:00\",\n          \"2019-12-04 00:00:00\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ID\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2885.765544949605,\n        \"min\": -1.0,\n        \"max\": 9999.0,\n        \"num_unique_values\": 9657,\n        \"samples\": [\n          3598.0,\n          9043.0,\n          3190.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"sales representative latitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1.7983439314431888,\n        \"min\": 34.406678,\n        \"max\": 43.3629267361237,\n        \"num_unique_values\": 34,\n        \"samples\": [\n          38.3617782825688,\n          40.3918706103675,\n          42.0382850410463\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"sales representative longitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3.3138225137699706,\n        \"min\": -118.616081,\n        \"max\": 2.20733580904726,\n        \"num_unique_values\": 34,\n        \"samples\": [\n          -0.493177134516378,\n          -3.62196936847687,\n          -1.14668411759499\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Sales Representative ID\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 9,\n        \"min\": 0,\n        \"max\": 32,\n        \"num_unique_values\": 33,\n        \"samples\": [\n          31,\n          1,\n          28\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":2}],"source":["# Mount Google Drive\n","drive.mount('/content/drive', force_remount=True)\n","\n","# Define the base path and data path\n","base_path = '/content/drive/Shared drives/Deloitte'\n","data_path = base_path + '/Original Data'\n","\n","# Load the Excel file\n","customer_info = pd.read_excel(data_path + '/customer_info.xlsx', sheet_name='Sheet1')\n","\n","# Display the first few rows of the dataframe\n","customer_info.head()"]},{"cell_type":"markdown","source":["#### Data Exploration"],"metadata":{"id":"vt--WYjWpcLR"},"id":"vt--WYjWpcLR"},{"cell_type":"code","execution_count":3,"id":"9ffae57f","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9ffae57f","executionInfo":{"status":"ok","timestamp":1720537072683,"user_tz":-120,"elapsed":25,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"4a484e30-dd7a-4ab6-8214-d7a53debe9be"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(9663, 16)"]},"metadata":{},"execution_count":3}],"source":["#checking the shape of the dataset\n","customer_info.shape"]},{"cell_type":"code","execution_count":4,"id":"48010715","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"48010715","executionInfo":{"status":"ok","timestamp":1720537072683,"user_tz":-120,"elapsed":23,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"9d67c731-71dc-44a1-84ec-3fb82e43c786"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["4"]},"metadata":{},"execution_count":4}],"source":["#checking for duplicates\n","customer_info.duplicated().sum()"]},{"cell_type":"code","execution_count":5,"id":"7d4b9420","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7d4b9420","executionInfo":{"status":"ok","timestamp":1720537072684,"user_tz":-120,"elapsed":21,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"81ad15bd-0c5c-495d-b0d1-99071c9ea835"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":5}],"source":["#drop the duplicates\n","customer_info.drop_duplicates(inplace=True)\n","customer_info.duplicated().sum()"]},{"cell_type":"code","execution_count":6,"id":"9a9f5b9e","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9a9f5b9e","executionInfo":{"status":"ok","timestamp":1720537072684,"user_tz":-120,"elapsed":19,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"2e0dff0b-a619-4657-8946-53f9cf5b6bdb"},"outputs":[{"output_type":"stream","name":"stdout","text":["Index(['Distance', 'City', 'Store.Size', 'Opening.Hours', 'Phone.Number',\n","       'Free.Wifi', 'Parking', 'Description', 'Zip.Code', 'Latitude',\n","       'Longitude', 'Date.Opening', 'ID', 'sales representative latitude',\n","       'sales representative longitude', 'Sales Representative ID'],\n","      dtype='object')\n"]}],"source":["#Checking for right column names\n","print(customer_info.columns)"]},{"cell_type":"code","execution_count":7,"id":"3e134564","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3e134564","executionInfo":{"status":"ok","timestamp":1720537072684,"user_tz":-120,"elapsed":16,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"338915ba-fbf4-4073-f15b-7847f7e5be79"},"outputs":[{"output_type":"stream","name":"stdout","text":["Index(['distance', 'city', 'store_size', 'opening_hours', 'phone_number',\n","       'free_wifi', 'parking', 'description', 'zip_code', 'latitude',\n","       'longitude', 'date_opening', 'id', 'sales_representative_latitude',\n","       'sales_representative_longitude', 'sales_representative_id'],\n","      dtype='object')\n"]}],"source":["#Rename column names\n","customer_info.columns = customer_info.columns.str.strip().str.lower().str.replace(' ', '_').str.replace('.', '_')\n","print(customer_info.columns)"]},{"cell_type":"code","execution_count":8,"id":"98dd8cca","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"98dd8cca","executionInfo":{"status":"ok","timestamp":1720537072684,"user_tz":-120,"elapsed":13,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"85edea3e-6ab1-4172-9d25-0db6ab735bc1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["distance                                  object\n","city                                      object\n","store_size                                object\n","opening_hours                             object\n","phone_number                              object\n","free_wifi                                 object\n","parking                                   object\n","description                               object\n","zip_code                                  object\n","latitude                                 float64\n","longitude                                float64\n","date_opening                      datetime64[ns]\n","id                                       float64\n","sales_representative_latitude            float64\n","sales_representative_longitude           float64\n","sales_representative_id                    int64\n","dtype: object"]},"metadata":{},"execution_count":8}],"source":["#checking for data types\n","customer_info.dtypes"]},{"cell_type":"code","execution_count":9,"id":"27c96272","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"27c96272","executionInfo":{"status":"ok","timestamp":1720537072684,"user_tz":-120,"elapsed":11,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"812f8de1-66aa-4773-b582-3a6024df4338"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["distance                           0\n","city                              33\n","store_size                         0\n","opening_hours                      0\n","phone_number                       0\n","free_wifi                          0\n","parking                            0\n","description                        0\n","zip_code                           0\n","latitude                           0\n","longitude                          0\n","date_opening                       0\n","id                                 2\n","sales_representative_latitude      0\n","sales_representative_longitude     0\n","sales_representative_id            0\n","dtype: int64"]},"metadata":{},"execution_count":9}],"source":["#checking for null values\n","customer_info.isna().sum()"]},{"cell_type":"markdown","source":["Now we are going through each variable to do the necessary changes for our analysis."],"metadata":{"id":"GB9VDxiCplal"},"id":"GB9VDxiCplal"},{"cell_type":"markdown","id":"2c789aca","metadata":{"id":"2c789aca"},"source":["#### City"]},{"cell_type":"code","execution_count":10,"id":"0dc5cef9","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0dc5cef9","executionInfo":{"status":"ok","timestamp":1720537072685,"user_tz":-120,"elapsed":10,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"775682b1-67a2-4015-e3a2-9417557aee2b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['Burgos', 'A  CoruÃ±a', 'Bilbao', 'Alicante', ' Madrid', 'Caceres',\n","       'Sevilla', 'Barcelona', 'Valencia', 'A Coruna', 'Zaragoza',\n","       'Guadalajara', 'Valladolid', 'Pamplona', nan, 'Valencia ',\n","       'Balencia', 'Bilb ao', 'Sevilla ', ' Barcelona', 'Bilbao '],\n","      dtype=object)"]},"metadata":{},"execution_count":10}],"source":["#Checking if all the names are aligned\n","customer_info['city'].unique()\n","#not consistent"]},{"cell_type":"code","execution_count":11,"id":"577dd59d","metadata":{"id":"577dd59d","executionInfo":{"status":"ok","timestamp":1720537072685,"user_tz":-120,"elapsed":7,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["#Cities contain spaces before or after the name so we want to strip this\n","customer_info['city'] = customer_info['city'].str.strip()"]},{"cell_type":"code","execution_count":12,"id":"40455e75","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"40455e75","executionInfo":{"status":"ok","timestamp":1720537073286,"user_tz":-120,"elapsed":608,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"58abf9ae-8f97-45f8-f054-1a69f53bf180"},"outputs":[{"output_type":"stream","name":"stdout","text":["City: Burgos, Zip Code: 9000\n","City: A  CoruÃ±a, Zip Code: 15000\n","City: Bilbao, Zip Code: 48000\n","City: Alicante, Zip Code: 3000\n","City: Madrid, Zip Code: 28000\n","City: Caceres, Zip Code: 10000\n","City: Sevilla, Zip Code: 41000\n","City: Barcelona, Zip Code: 8000\n","City: Valencia, Zip Code: 46000\n","City: A Coruna, Zip Code: 15000\n","City: Zaragoza, Zip Code: 50000\n","City: Guadalajara, Zip Code: 19000\n","City: Valladolid, Zip Code: 47000\n","City: Pamplona, Zip Code: 31000\n","City: nan, Zip Code: 30000\n","City: Balencia, Zip Code: 34000\n","City: Bilb ao, Zip Code: 48000\n"]}],"source":["printed_cities = set()\n","\n","# Iterate over the rows of the DataFrame\n","for index, row in customer_info.iterrows():\n","    if row['city'] not in printed_cities:\n","        print(f\"City: {row['city']}, Zip Code: {row['zip_code']}\")\n","        printed_cities.add(row['city'])"]},{"cell_type":"code","execution_count":13,"id":"a1c186f4","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"a1c186f4","executionInfo":{"status":"ok","timestamp":1720537073286,"user_tz":-120,"elapsed":10,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"883ae9c5-b776-4c2a-a032-41054c801fd2"},"outputs":[{"output_type":"stream","name":"stdout","text":["['Burgos' 'A Coruña' 'Bilbao' 'Alicante' 'Madrid' 'Caceres' 'Sevilla'\n"," 'Barcelona' 'Valencia' 'Zaragoza' 'Guadalajara' 'Valladolid' 'Pamplona'\n"," nan 'Palencia']\n"]}],"source":["#Align all the names\n","city_mapping = {\n","    'A  CoruÃ±a': 'A Coruña',\n","    'A Coruna': 'A Coruña',\n","    'Balencia': 'Palencia',\n","    'Bilb ao': 'Bilbao',\n","    'Bilbao': 'Bilbao',\n","}\n","\n","customer_info['city'] = customer_info['city'].replace(city_mapping)\n","\n","print(customer_info['city'].unique())"]},{"cell_type":"code","execution_count":14,"id":"63c3bcdb","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"63c3bcdb","executionInfo":{"status":"ok","timestamp":1720537073286,"user_tz":-120,"elapsed":9,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"32d0c69b-21b8-411b-81d0-4bebe6983f0f"},"outputs":[{"output_type":"stream","name":"stdout","text":["Zip Code: 30000\n"]}],"source":["printed_zip_codes = set()\n","\n","for zip_code in customer_info.loc[customer_info['city'].isna(), 'zip_code']:\n","    if zip_code not in printed_zip_codes:\n","        print(\"Zip Code:\", zip_code)\n","        printed_zip_codes.add(zip_code)"]},{"cell_type":"markdown","source":["We imputed the missing zip code values using the corresponding city names."],"metadata":{"id":"txG1HwN3qbdL"},"id":"txG1HwN3qbdL"},{"cell_type":"code","execution_count":15,"id":"02953ee1","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"02953ee1","executionInfo":{"status":"ok","timestamp":1720537073286,"user_tz":-120,"elapsed":7,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"77a924bb-e451-46b5-9468-6ec9e3abc768"},"outputs":[{"output_type":"stream","name":"stdout","text":["        city zip_code\n","236   Murcia    30000\n","745   Murcia    30000\n","770   Murcia    30000\n","1206  Murcia    30000\n","1318  Murcia    30000\n","1659  Murcia    30000\n","1807  Murcia    30000\n","1903  Murcia    30000\n","2036  Murcia    30000\n","2208  Murcia    30000\n","2429  Murcia    30000\n","2708  Murcia    30000\n","3256  Murcia    30000\n","3517  Murcia    30000\n","4063  Murcia    30000\n","4183  Murcia    30000\n","4671  Murcia    30000\n","4925  Murcia    30000\n","4997  Murcia    30000\n","5561  Murcia    30000\n","5731  Murcia    30000\n","5831  Murcia    30000\n","6034  Murcia    30000\n","6698  Murcia    30000\n","6911  Murcia    30000\n","7233  Murcia    30000\n","7420  Murcia    30000\n","8238  Murcia    30000\n","8723  Murcia    30000\n","8932  Murcia    30000\n","9006  Murcia    30000\n","9072  Murcia    30000\n","9269  Murcia    30000\n"]}],"source":["#Zip Code 30000 belongs to Murcia which is also found back in the Sociodemographic dataset\n","customer_info.loc[(customer_info['city'].isna()) & (customer_info['zip_code'] == 30000), 'city'] = 'Murcia'\n","print(customer_info.loc[(customer_info['city'] == 'Murcia') & (customer_info['zip_code'] == 30000), ['city', 'zip_code']])\n"]},{"cell_type":"markdown","id":"c55c332f","metadata":{"id":"c55c332f"},"source":["#### Distance"]},{"cell_type":"code","execution_count":16,"id":"2a4962b7","metadata":{"id":"2a4962b7","executionInfo":{"status":"ok","timestamp":1720537073286,"user_tz":-120,"elapsed":4,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"colab":{"base_uri":"https://localhost:8080/","height":98},"outputId":"80a7ac79-c9c2-4dc4-80c4-7a2dbb79ac24"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["      distance      city store_size        opening_hours phone_number  \\\n","5764       NaN  Valencia        832  10:00 AM - 10:30 PM    954082954   \n","\n","     free_wifi parking                                        description  \\\n","5764         1       0  Warmly lit, rustic tables and vintage amphorae...   \n","\n","     zip_code   latitude  longitude date_opening      id  \\\n","5764    46000  39.439743  -0.614929   2018-10-17  5927.0   \n","\n","      sales_representative_latitude  sales_representative_longitude  \\\n","5764                      39.451345                       -0.507719   \n","\n","      sales_representative_id  \n","5764                       27  "],"text/html":["\n","  <div id=\"df-b179f038-e1bf-4597-a224-1736fbc9aee8\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>distance</th>\n","      <th>city</th>\n","      <th>store_size</th>\n","      <th>opening_hours</th>\n","      <th>phone_number</th>\n","      <th>free_wifi</th>\n","      <th>parking</th>\n","      <th>description</th>\n","      <th>zip_code</th>\n","      <th>latitude</th>\n","      <th>longitude</th>\n","      <th>date_opening</th>\n","      <th>id</th>\n","      <th>sales_representative_latitude</th>\n","      <th>sales_representative_longitude</th>\n","      <th>sales_representative_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>5764</th>\n","      <td>NaN</td>\n","      <td>Valencia</td>\n","      <td>832</td>\n","      <td>10:00 AM - 10:30 PM</td>\n","      <td>954082954</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Warmly lit, rustic tables and vintage amphorae...</td>\n","      <td>46000</td>\n","      <td>39.439743</td>\n","      <td>-0.614929</td>\n","      <td>2018-10-17</td>\n","      <td>5927.0</td>\n","      <td>39.451345</td>\n","      <td>-0.507719</td>\n","      <td>27</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b179f038-e1bf-4597-a224-1736fbc9aee8')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-b179f038-e1bf-4597-a224-1736fbc9aee8 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-b179f038-e1bf-4597-a224-1736fbc9aee8');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","repr_error":"0"}},"metadata":{},"execution_count":16}],"source":["#Change the non numerical values to NA values\n","customer_info['distance'] = pd.to_numeric(customer_info['distance'], errors='coerce')\n","customer_info[customer_info['distance'].isna()]"]},{"cell_type":"code","execution_count":17,"id":"d87dbfbc","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":293},"id":"d87dbfbc","executionInfo":{"status":"ok","timestamp":1720537073748,"user_tz":-120,"elapsed":465,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"48521869-53af-4182-f5c2-af00f230468b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["          distance      city store_size        opening_hours phone_number  \\\n","7134  3.139363e+14  A Coruña        405  11:00 AM - 11:00 PM    923985234   \n","1067  5.139281e+01  Zaragoza       2893   6:00 AM - 11:00 PM    926951547   \n","3981  5.073062e+01    Bilbao        223    1:00 PM - 1:00 AM    944002958   \n","8487  5.021472e+01    Madrid       1379  11:00 AM - 11:00 PM    944907350   \n","8698  4.976854e+01    Madrid        685  10:00 AM - 10:30 PM    955948520   \n","\n","     free_wifi parking                                        description  \\\n","7134         1       1  Warm aromas of lemongrass and galangal waft th...   \n","1067         0       0  A cozy retreat for furry friends and their own...   \n","3981         1       1  Warm lighting illuminates the cozy atmosphere ...   \n","8487         1       1  Warm wooden accents, rich Guinness aromas, and...   \n","8698         1       0  Vibrant eatery serving aromatic curries, fluff...   \n","\n","     zip_code   latitude  longitude date_opening      id  \\\n","7134    15000  43.355112  -8.414948   2019-07-29  7364.0   \n","1067    50000  41.663860  -0.877472   2019-01-23  1096.0   \n","3981    48000  43.243532  -2.937730   2019-04-04  4099.0   \n","8487    28000  40.398512  -3.695807   2019-07-03  8772.0   \n","8698    28000  40.398957  -3.696045   2018-09-11  8994.0   \n","\n","      sales_representative_latitude  sales_representative_longitude  \\\n","7134                      43.354738                       -8.424556   \n","1067                      41.651911                       -0.873774   \n","3981                      43.262941                       -2.935849   \n","8487                      40.397281                       -3.694624   \n","8698                      40.397281                       -3.694624   \n","\n","      sales_representative_id  \n","7134                        0  \n","1067                       30  \n","3981                       10  \n","8487                       31  \n","8698                       31  "],"text/html":["\n","  <div id=\"df-0d818ec8-c1d1-4fdf-b68f-6faeded4abdc\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>distance</th>\n","      <th>city</th>\n","      <th>store_size</th>\n","      <th>opening_hours</th>\n","      <th>phone_number</th>\n","      <th>free_wifi</th>\n","      <th>parking</th>\n","      <th>description</th>\n","      <th>zip_code</th>\n","      <th>latitude</th>\n","      <th>longitude</th>\n","      <th>date_opening</th>\n","      <th>id</th>\n","      <th>sales_representative_latitude</th>\n","      <th>sales_representative_longitude</th>\n","      <th>sales_representative_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>7134</th>\n","      <td>3.139363e+14</td>\n","      <td>A Coruña</td>\n","      <td>405</td>\n","      <td>11:00 AM - 11:00 PM</td>\n","      <td>923985234</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Warm aromas of lemongrass and galangal waft th...</td>\n","      <td>15000</td>\n","      <td>43.355112</td>\n","      <td>-8.414948</td>\n","      <td>2019-07-29</td>\n","      <td>7364.0</td>\n","      <td>43.354738</td>\n","      <td>-8.424556</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1067</th>\n","      <td>5.139281e+01</td>\n","      <td>Zaragoza</td>\n","      <td>2893</td>\n","      <td>6:00 AM - 11:00 PM</td>\n","      <td>926951547</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>A cozy retreat for furry friends and their own...</td>\n","      <td>50000</td>\n","      <td>41.663860</td>\n","      <td>-0.877472</td>\n","      <td>2019-01-23</td>\n","      <td>1096.0</td>\n","      <td>41.651911</td>\n","      <td>-0.873774</td>\n","      <td>30</td>\n","    </tr>\n","    <tr>\n","      <th>3981</th>\n","      <td>5.073062e+01</td>\n","      <td>Bilbao</td>\n","      <td>223</td>\n","      <td>1:00 PM - 1:00 AM</td>\n","      <td>944002958</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Warm lighting illuminates the cozy atmosphere ...</td>\n","      <td>48000</td>\n","      <td>43.243532</td>\n","      <td>-2.937730</td>\n","      <td>2019-04-04</td>\n","      <td>4099.0</td>\n","      <td>43.262941</td>\n","      <td>-2.935849</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>8487</th>\n","      <td>5.021472e+01</td>\n","      <td>Madrid</td>\n","      <td>1379</td>\n","      <td>11:00 AM - 11:00 PM</td>\n","      <td>944907350</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Warm wooden accents, rich Guinness aromas, and...</td>\n","      <td>28000</td>\n","      <td>40.398512</td>\n","      <td>-3.695807</td>\n","      <td>2019-07-03</td>\n","      <td>8772.0</td>\n","      <td>40.397281</td>\n","      <td>-3.694624</td>\n","      <td>31</td>\n","    </tr>\n","    <tr>\n","      <th>8698</th>\n","      <td>4.976854e+01</td>\n","      <td>Madrid</td>\n","      <td>685</td>\n","      <td>10:00 AM - 10:30 PM</td>\n","      <td>955948520</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Vibrant eatery serving aromatic curries, fluff...</td>\n","      <td>28000</td>\n","      <td>40.398957</td>\n","      <td>-3.696045</td>\n","      <td>2018-09-11</td>\n","      <td>8994.0</td>\n","      <td>40.397281</td>\n","      <td>-3.694624</td>\n","      <td>31</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0d818ec8-c1d1-4fdf-b68f-6faeded4abdc')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-0d818ec8-c1d1-4fdf-b68f-6faeded4abdc button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-0d818ec8-c1d1-4fdf-b68f-6faeded4abdc');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-e108612c-b498-45b4-87f9-1959501790d8\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-e108612c-b498-45b4-87f9-1959501790d8')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-e108612c-b498-45b4-87f9-1959501790d8 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","repr_error":"0"}},"metadata":{},"execution_count":17}],"source":["customer_info.sort_values(by='distance', ascending=False).head()\n","#Assuming the distance of Store ID = 7364 is an outlier"]},{"cell_type":"code","execution_count":18,"id":"34fcbb25","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":293},"id":"34fcbb25","executionInfo":{"status":"ok","timestamp":1720537073748,"user_tz":-120,"elapsed":21,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"d57ea7ac-c7eb-464d-fd63-ff7331a6f604"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["       distance       city store_size        opening_hours phone_number  \\\n","3111  -1.000000  Barcelona       3536   6:00 AM - 11:00 PM    923649651   \n","6     -1.000000     Burgos       3488  12:00 AM - 12:00 AM    920655895   \n","2376  22.655179  Barcelona        242    1:00 PM - 2:00 AM    946643870   \n","8353  22.818016    Sevilla       4331    9:00 AM - 9:00 PM    958071239   \n","3943  23.172458    Sevilla       1289   6:00 AM - 11:00 PM    922451788   \n","\n","     free_wifi parking                                        description  \\\n","3111         1       0  A sumptuous retreat of opulence, where lavish ...   \n","6            1       1  Serenely situated amidst powdery white sands a...   \n","2376         0       1  Warm and inviting, this theme pub transports p...   \n","8353         1       1  Luxurious oasis retreat offering serene ambian...   \n","3943         0       1  Serenely situated amidst powdery white sands a...   \n","\n","     zip_code   latitude  longitude date_opening      id  \\\n","3111     8000  41.339120   2.094226   2018-10-26  3199.0   \n","6        9000  42.323377  -3.783294   2019-12-27     7.0   \n","2376     8000  41.471947   2.172713   2019-06-24  2437.0   \n","8353    41000  37.386907  -5.944648   2020-01-31  8634.0   \n","3943    41000  37.412711  -5.999849   2020-02-09  4060.0   \n","\n","      sales_representative_latitude  sales_representative_longitude  \\\n","3111                      41.369630                        2.110279   \n","6                         42.330026                       -3.719371   \n","2376                      41.426438                        2.176616   \n","8353                      37.391761                       -5.941748   \n","3943                      37.390124                       -5.995078   \n","\n","      sales_representative_id  \n","3111                       21  \n","6                          25  \n","2376                        3  \n","8353                       20  \n","3943                        6  "],"text/html":["\n","  <div id=\"df-a918027e-b0c8-4c54-9710-5eef08bd31cd\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>distance</th>\n","      <th>city</th>\n","      <th>store_size</th>\n","      <th>opening_hours</th>\n","      <th>phone_number</th>\n","      <th>free_wifi</th>\n","      <th>parking</th>\n","      <th>description</th>\n","      <th>zip_code</th>\n","      <th>latitude</th>\n","      <th>longitude</th>\n","      <th>date_opening</th>\n","      <th>id</th>\n","      <th>sales_representative_latitude</th>\n","      <th>sales_representative_longitude</th>\n","      <th>sales_representative_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>3111</th>\n","      <td>-1.000000</td>\n","      <td>Barcelona</td>\n","      <td>3536</td>\n","      <td>6:00 AM - 11:00 PM</td>\n","      <td>923649651</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>A sumptuous retreat of opulence, where lavish ...</td>\n","      <td>8000</td>\n","      <td>41.339120</td>\n","      <td>2.094226</td>\n","      <td>2018-10-26</td>\n","      <td>3199.0</td>\n","      <td>41.369630</td>\n","      <td>2.110279</td>\n","      <td>21</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>-1.000000</td>\n","      <td>Burgos</td>\n","      <td>3488</td>\n","      <td>12:00 AM - 12:00 AM</td>\n","      <td>920655895</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Serenely situated amidst powdery white sands a...</td>\n","      <td>9000</td>\n","      <td>42.323377</td>\n","      <td>-3.783294</td>\n","      <td>2019-12-27</td>\n","      <td>7.0</td>\n","      <td>42.330026</td>\n","      <td>-3.719371</td>\n","      <td>25</td>\n","    </tr>\n","    <tr>\n","      <th>2376</th>\n","      <td>22.655179</td>\n","      <td>Barcelona</td>\n","      <td>242</td>\n","      <td>1:00 PM - 2:00 AM</td>\n","      <td>946643870</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>Warm and inviting, this theme pub transports p...</td>\n","      <td>8000</td>\n","      <td>41.471947</td>\n","      <td>2.172713</td>\n","      <td>2019-06-24</td>\n","      <td>2437.0</td>\n","      <td>41.426438</td>\n","      <td>2.176616</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>8353</th>\n","      <td>22.818016</td>\n","      <td>Sevilla</td>\n","      <td>4331</td>\n","      <td>9:00 AM - 9:00 PM</td>\n","      <td>958071239</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Luxurious oasis retreat offering serene ambian...</td>\n","      <td>41000</td>\n","      <td>37.386907</td>\n","      <td>-5.944648</td>\n","      <td>2020-01-31</td>\n","      <td>8634.0</td>\n","      <td>37.391761</td>\n","      <td>-5.941748</td>\n","      <td>20</td>\n","    </tr>\n","    <tr>\n","      <th>3943</th>\n","      <td>23.172458</td>\n","      <td>Sevilla</td>\n","      <td>1289</td>\n","      <td>6:00 AM - 11:00 PM</td>\n","      <td>922451788</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>Serenely situated amidst powdery white sands a...</td>\n","      <td>41000</td>\n","      <td>37.412711</td>\n","      <td>-5.999849</td>\n","      <td>2020-02-09</td>\n","      <td>4060.0</td>\n","      <td>37.390124</td>\n","      <td>-5.995078</td>\n","      <td>6</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a918027e-b0c8-4c54-9710-5eef08bd31cd')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-a918027e-b0c8-4c54-9710-5eef08bd31cd button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-a918027e-b0c8-4c54-9710-5eef08bd31cd');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-a1a4f35f-6295-44da-b70f-3478219f08a3\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-a1a4f35f-6295-44da-b70f-3478219f08a3')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-a1a4f35f-6295-44da-b70f-3478219f08a3 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","repr_error":"0"}},"metadata":{},"execution_count":18}],"source":["customer_info.sort_values(by='distance', ascending=True).head()\n","#Assuming a negative distance of Store ID = 3199 and ID = 7 is wrong"]},{"cell_type":"markdown","source":["We decided to fill the assumed incorrect and null distance values with the average distance of the corresponding city."],"metadata":{"id":"1flKlZjHtK25"},"id":"1flKlZjHtK25"},{"cell_type":"code","execution_count":19,"id":"a192d5dc","metadata":{"id":"a192d5dc","executionInfo":{"status":"ok","timestamp":1720537073748,"user_tz":-120,"elapsed":20,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["#Filling the stores that have an assumed wrong distance with NaN\n","customer_info['distance'] = customer_info['distance'].mask(\n","    (customer_info['distance'] < 0) | (customer_info['distance'] > 100), np.nan)"]},{"cell_type":"code","execution_count":20,"id":"6b4bd244","metadata":{"id":"6b4bd244","executionInfo":{"status":"ok","timestamp":1720537073748,"user_tz":-120,"elapsed":20,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["#Fill the NA value with the average distance of that city\n","mean_distances = customer_info.groupby('city')['distance'].transform('mean')\n","customer_info['distance'] = customer_info['distance'].fillna(mean_distances)"]},{"cell_type":"markdown","id":"0b19f47a","metadata":{"id":"0b19f47a"},"source":["#### Store size"]},{"cell_type":"code","execution_count":21,"id":"4cc92a0a","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":196},"id":"4cc92a0a","executionInfo":{"status":"ok","timestamp":1720537073749,"user_tz":-120,"elapsed":21,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"436272b0-8f7b-4242-8e7e-fb7513e7b0a7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["       distance      city  store_size        opening_hours phone_number  \\\n","3929  43.624822  A Coruña         NaN  11:00 AM - 11:00 PM    929056158   \n","7940  31.146298    Madrid         NaN    1:00 PM - 1:00 AM    928692629   \n","9089  29.713359  Alicante         NaN  11:00 AM - 11:00 PM    935671836   \n","\n","     free_wifi parking                                        description  \\\n","3929         1       0  Vibrant tapas bar serving authentic paella and...   \n","7940         0       1  Vibrant hues of turquoise and red adorn the ex...   \n","9089         1       0  Warm ambiance wraps around you like a cozy bla...   \n","\n","     zip_code   latitude  longitude date_opening      id  \\\n","3929    15000  43.349890  -8.421261   2020-04-07  4045.0   \n","7940    28000  40.399422  -3.696802   2020-05-01  8200.0   \n","9089     3000  38.395357  -0.477776   2019-04-01  9398.0   \n","\n","      sales_representative_latitude  sales_representative_longitude  \\\n","3929                      43.354738                       -8.424556   \n","7940                      40.403571                       -3.697315   \n","9089                      39.211691                       -0.410767   \n","\n","      sales_representative_id  \n","3929                        0  \n","7940                       23  \n","9089                       19  "],"text/html":["\n","  <div id=\"df-c0315851-f228-4984-b28f-2c97723f1e55\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>distance</th>\n","      <th>city</th>\n","      <th>store_size</th>\n","      <th>opening_hours</th>\n","      <th>phone_number</th>\n","      <th>free_wifi</th>\n","      <th>parking</th>\n","      <th>description</th>\n","      <th>zip_code</th>\n","      <th>latitude</th>\n","      <th>longitude</th>\n","      <th>date_opening</th>\n","      <th>id</th>\n","      <th>sales_representative_latitude</th>\n","      <th>sales_representative_longitude</th>\n","      <th>sales_representative_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>3929</th>\n","      <td>43.624822</td>\n","      <td>A Coruña</td>\n","      <td>NaN</td>\n","      <td>11:00 AM - 11:00 PM</td>\n","      <td>929056158</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Vibrant tapas bar serving authentic paella and...</td>\n","      <td>15000</td>\n","      <td>43.349890</td>\n","      <td>-8.421261</td>\n","      <td>2020-04-07</td>\n","      <td>4045.0</td>\n","      <td>43.354738</td>\n","      <td>-8.424556</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>7940</th>\n","      <td>31.146298</td>\n","      <td>Madrid</td>\n","      <td>NaN</td>\n","      <td>1:00 PM - 1:00 AM</td>\n","      <td>928692629</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>Vibrant hues of turquoise and red adorn the ex...</td>\n","      <td>28000</td>\n","      <td>40.399422</td>\n","      <td>-3.696802</td>\n","      <td>2020-05-01</td>\n","      <td>8200.0</td>\n","      <td>40.403571</td>\n","      <td>-3.697315</td>\n","      <td>23</td>\n","    </tr>\n","    <tr>\n","      <th>9089</th>\n","      <td>29.713359</td>\n","      <td>Alicante</td>\n","      <td>NaN</td>\n","      <td>11:00 AM - 11:00 PM</td>\n","      <td>935671836</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Warm ambiance wraps around you like a cozy bla...</td>\n","      <td>3000</td>\n","      <td>38.395357</td>\n","      <td>-0.477776</td>\n","      <td>2019-04-01</td>\n","      <td>9398.0</td>\n","      <td>39.211691</td>\n","      <td>-0.410767</td>\n","      <td>19</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c0315851-f228-4984-b28f-2c97723f1e55')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-c0315851-f228-4984-b28f-2c97723f1e55 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-c0315851-f228-4984-b28f-2c97723f1e55');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-54d7486f-c54e-4b4f-9980-35c1da1789ab\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-54d7486f-c54e-4b4f-9980-35c1da1789ab')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-54d7486f-c54e-4b4f-9980-35c1da1789ab button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","repr_error":"0"}},"metadata":{},"execution_count":21}],"source":["#There are some non numerical variables that we want to change to NaN to fill after with the average\n","#Very Big/ Small/ Not available, instead of guessing what they mean with those sizes we will imput the average\n","customer_info['store_size'] = pd.to_numeric(customer_info['store_size'], errors='coerce')\n","customer_info[customer_info['store_size'].isna()]"]},{"cell_type":"code","execution_count":22,"id":"391d9c4f","metadata":{"id":"391d9c4f","executionInfo":{"status":"ok","timestamp":1720537073749,"user_tz":-120,"elapsed":20,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["#store size in in squared ft, we change it m2 (number/10.764)\n","sqft_to_m2 = 0.0929\n","customer_info['store_size'] = customer_info['store_size'] * sqft_to_m2"]},{"cell_type":"markdown","id":"9c5bb1b4","metadata":{"id":"9c5bb1b4"},"source":["Handling extreme values for store size"]},{"cell_type":"code","execution_count":23,"id":"4b6746e8","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":293},"id":"4b6746e8","executionInfo":{"status":"ok","timestamp":1720537073749,"user_tz":-120,"elapsed":20,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"f0506ce4-ed02-4afb-b9ee-5478942b8dac"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["       distance       city  store_size       opening_hours phone_number  \\\n","9653  34.237723     Burgos      0.2787   1:00 PM - 1:00 AM    926222059   \n","2791  32.792255  Barcelona      9.2900  11:00 PM - 6:00 AM    934803025   \n","799   41.064160   A Coruña      9.4758  11:00 PM - 6:00 AM    958837901   \n","2391  34.508070   Valencia      9.5687   1:00 PM - 2:00 AM    956835804   \n","5464  37.125719   Alicante      9.5687  11:00 PM - 6:00 AM    953462305   \n","\n","     free_wifi parking                                        description  \\\n","9653         1       1  Vibrant tapas bar serving authentic paella and...   \n","2791         1       1  Vibrant dive pub radiates warmth, walls adorne...   \n","799          1       0  Warm and inviting, rustic charm abounds in thi...   \n","2391         1       1  Warm wooden accents, rich Guinness aromas, and...   \n","5464         0       1  Warm golden lighting envelops the rustic woode...   \n","\n","     zip_code   latitude  longitude date_opening      id  \\\n","9653     9000  42.346848  -3.706798   2018-12-08  9989.0   \n","2791     8000  41.360494   2.113104   2020-09-05  2866.0   \n","799     15000  43.352379  -8.419751   2020-12-11   818.0   \n","2391    46000  39.753948  -0.272731   2020-04-23  2454.0   \n","5464     3000  38.355024  -0.522091   2019-12-12  5618.0   \n","\n","      sales_representative_latitude  sales_representative_longitude  \\\n","9653                      42.330026                       -3.719371   \n","2791                      41.369630                        2.110279   \n","799                       43.354738                       -8.424556   \n","2391                      39.597422                       -0.351167   \n","5464                      38.300530                       -0.604413   \n","\n","      sales_representative_id  \n","9653                       25  \n","2791                       21  \n","799                         0  \n","2391                       17  \n","5464                       15  "],"text/html":["\n","  <div id=\"df-922a2e38-6f87-4a52-a8b2-4ab039fb178a\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>distance</th>\n","      <th>city</th>\n","      <th>store_size</th>\n","      <th>opening_hours</th>\n","      <th>phone_number</th>\n","      <th>free_wifi</th>\n","      <th>parking</th>\n","      <th>description</th>\n","      <th>zip_code</th>\n","      <th>latitude</th>\n","      <th>longitude</th>\n","      <th>date_opening</th>\n","      <th>id</th>\n","      <th>sales_representative_latitude</th>\n","      <th>sales_representative_longitude</th>\n","      <th>sales_representative_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>9653</th>\n","      <td>34.237723</td>\n","      <td>Burgos</td>\n","      <td>0.2787</td>\n","      <td>1:00 PM - 1:00 AM</td>\n","      <td>926222059</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Vibrant tapas bar serving authentic paella and...</td>\n","      <td>9000</td>\n","      <td>42.346848</td>\n","      <td>-3.706798</td>\n","      <td>2018-12-08</td>\n","      <td>9989.0</td>\n","      <td>42.330026</td>\n","      <td>-3.719371</td>\n","      <td>25</td>\n","    </tr>\n","    <tr>\n","      <th>2791</th>\n","      <td>32.792255</td>\n","      <td>Barcelona</td>\n","      <td>9.2900</td>\n","      <td>11:00 PM - 6:00 AM</td>\n","      <td>934803025</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Vibrant dive pub radiates warmth, walls adorne...</td>\n","      <td>8000</td>\n","      <td>41.360494</td>\n","      <td>2.113104</td>\n","      <td>2020-09-05</td>\n","      <td>2866.0</td>\n","      <td>41.369630</td>\n","      <td>2.110279</td>\n","      <td>21</td>\n","    </tr>\n","    <tr>\n","      <th>799</th>\n","      <td>41.064160</td>\n","      <td>A Coruña</td>\n","      <td>9.4758</td>\n","      <td>11:00 PM - 6:00 AM</td>\n","      <td>958837901</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Warm and inviting, rustic charm abounds in thi...</td>\n","      <td>15000</td>\n","      <td>43.352379</td>\n","      <td>-8.419751</td>\n","      <td>2020-12-11</td>\n","      <td>818.0</td>\n","      <td>43.354738</td>\n","      <td>-8.424556</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2391</th>\n","      <td>34.508070</td>\n","      <td>Valencia</td>\n","      <td>9.5687</td>\n","      <td>1:00 PM - 2:00 AM</td>\n","      <td>956835804</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Warm wooden accents, rich Guinness aromas, and...</td>\n","      <td>46000</td>\n","      <td>39.753948</td>\n","      <td>-0.272731</td>\n","      <td>2020-04-23</td>\n","      <td>2454.0</td>\n","      <td>39.597422</td>\n","      <td>-0.351167</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>5464</th>\n","      <td>37.125719</td>\n","      <td>Alicante</td>\n","      <td>9.5687</td>\n","      <td>11:00 PM - 6:00 AM</td>\n","      <td>953462305</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>Warm golden lighting envelops the rustic woode...</td>\n","      <td>3000</td>\n","      <td>38.355024</td>\n","      <td>-0.522091</td>\n","      <td>2019-12-12</td>\n","      <td>5618.0</td>\n","      <td>38.300530</td>\n","      <td>-0.604413</td>\n","      <td>15</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-922a2e38-6f87-4a52-a8b2-4ab039fb178a')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-922a2e38-6f87-4a52-a8b2-4ab039fb178a button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-922a2e38-6f87-4a52-a8b2-4ab039fb178a');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-3161c1f4-552c-4c3a-8e77-395452dbcd9a\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-3161c1f4-552c-4c3a-8e77-395452dbcd9a')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-3161c1f4-552c-4c3a-8e77-395452dbcd9a button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","repr_error":"0"}},"metadata":{},"execution_count":23}],"source":["customer_info.sort_values(by='store_size', ascending=True).head()"]},{"cell_type":"code","source":["customer_info.sort_values(by='store_size', ascending=False).head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":293},"id":"VDpf8GDDxb45","executionInfo":{"status":"ok","timestamp":1720537073749,"user_tz":-120,"elapsed":18,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"e6035a9e-9537-4075-eadd-0ab4711ebe19"},"id":"VDpf8GDDxb45","execution_count":24,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       distance       city  store_size        opening_hours phone_number  \\\n","0     35.820157     Burgos  33706.0709    1:00 PM - 1:00 AM    941096462   \n","2142  32.188306     Bilbao    464.3142    9:00 AM - 9:00 PM    914738027   \n","8180  28.208130  Barcelona    464.2213    9:00 AM - 9:00 PM    914598412   \n","811   31.961559   Valencia    464.0355    9:00 AM - 9:00 PM    936018069   \n","1610  30.308747     Madrid    464.0355  12:00 AM - 12:00 AM    911233124   \n","\n","     free_wifi parking                                        description  \\\n","0            1       0  Vibrant hues of turquoise and red adorn the ex...   \n","2142         1       1  Luxurious haven where luck and indulgence conv...   \n","8180         1       1  Intimate oasis blending luxurious comforts wit...   \n","811          1       1  Sustainable retreat blending harmoniously with...   \n","1610         1       0  Tiny, futuristic sanctuaries offering luxuriou...   \n","\n","     zip_code   latitude  longitude date_opening      id  \\\n","0        9000  42.352143  -3.677571   2019-07-10     1.0   \n","2142    48000  43.248193  -2.929992   2019-01-01  2199.0   \n","8180     8000  41.420159   2.206459   2020-03-08  8451.0   \n","811     46000  39.615729  -0.369921   2020-03-28   831.0   \n","1610    28000  40.471294  -3.604190   2018-06-14  1661.0   \n","\n","      sales_representative_latitude  sales_representative_longitude  \\\n","0                         42.330026                       -3.719371   \n","2142                      43.262941                       -2.935849   \n","8180                      41.414298                        2.207336   \n","811                       39.597422                       -0.351167   \n","1610                      40.453918                       -3.654711   \n","\n","      sales_representative_id  \n","0                          25  \n","2142                       10  \n","8180                       26  \n","811                        17  \n","1610                       29  "],"text/html":["\n","  <div id=\"df-b39e31ea-8c8f-4a07-a86e-d82f553c6950\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>distance</th>\n","      <th>city</th>\n","      <th>store_size</th>\n","      <th>opening_hours</th>\n","      <th>phone_number</th>\n","      <th>free_wifi</th>\n","      <th>parking</th>\n","      <th>description</th>\n","      <th>zip_code</th>\n","      <th>latitude</th>\n","      <th>longitude</th>\n","      <th>date_opening</th>\n","      <th>id</th>\n","      <th>sales_representative_latitude</th>\n","      <th>sales_representative_longitude</th>\n","      <th>sales_representative_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>35.820157</td>\n","      <td>Burgos</td>\n","      <td>33706.0709</td>\n","      <td>1:00 PM - 1:00 AM</td>\n","      <td>941096462</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Vibrant hues of turquoise and red adorn the ex...</td>\n","      <td>9000</td>\n","      <td>42.352143</td>\n","      <td>-3.677571</td>\n","      <td>2019-07-10</td>\n","      <td>1.0</td>\n","      <td>42.330026</td>\n","      <td>-3.719371</td>\n","      <td>25</td>\n","    </tr>\n","    <tr>\n","      <th>2142</th>\n","      <td>32.188306</td>\n","      <td>Bilbao</td>\n","      <td>464.3142</td>\n","      <td>9:00 AM - 9:00 PM</td>\n","      <td>914738027</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Luxurious haven where luck and indulgence conv...</td>\n","      <td>48000</td>\n","      <td>43.248193</td>\n","      <td>-2.929992</td>\n","      <td>2019-01-01</td>\n","      <td>2199.0</td>\n","      <td>43.262941</td>\n","      <td>-2.935849</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>8180</th>\n","      <td>28.208130</td>\n","      <td>Barcelona</td>\n","      <td>464.2213</td>\n","      <td>9:00 AM - 9:00 PM</td>\n","      <td>914598412</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Intimate oasis blending luxurious comforts wit...</td>\n","      <td>8000</td>\n","      <td>41.420159</td>\n","      <td>2.206459</td>\n","      <td>2020-03-08</td>\n","      <td>8451.0</td>\n","      <td>41.414298</td>\n","      <td>2.207336</td>\n","      <td>26</td>\n","    </tr>\n","    <tr>\n","      <th>811</th>\n","      <td>31.961559</td>\n","      <td>Valencia</td>\n","      <td>464.0355</td>\n","      <td>9:00 AM - 9:00 PM</td>\n","      <td>936018069</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Sustainable retreat blending harmoniously with...</td>\n","      <td>46000</td>\n","      <td>39.615729</td>\n","      <td>-0.369921</td>\n","      <td>2020-03-28</td>\n","      <td>831.0</td>\n","      <td>39.597422</td>\n","      <td>-0.351167</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>1610</th>\n","      <td>30.308747</td>\n","      <td>Madrid</td>\n","      <td>464.0355</td>\n","      <td>12:00 AM - 12:00 AM</td>\n","      <td>911233124</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Tiny, futuristic sanctuaries offering luxuriou...</td>\n","      <td>28000</td>\n","      <td>40.471294</td>\n","      <td>-3.604190</td>\n","      <td>2018-06-14</td>\n","      <td>1661.0</td>\n","      <td>40.453918</td>\n","      <td>-3.654711</td>\n","      <td>29</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b39e31ea-8c8f-4a07-a86e-d82f553c6950')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-b39e31ea-8c8f-4a07-a86e-d82f553c6950 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-b39e31ea-8c8f-4a07-a86e-d82f553c6950');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-31315bb9-d045-4216-a7d5-4410366aac2c\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-31315bb9-d045-4216-a7d5-4410366aac2c')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-31315bb9-d045-4216-a7d5-4410366aac2c button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"customer_info\",\n  \"rows\": 5,\n  \"fields\": [\n    {\n      \"column\": \"distance\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2.8022873655570746,\n        \"min\": 28.2081301270433,\n        \"max\": 35.8201572659696,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          32.1883055117735,\n          30.3087467482206,\n          28.2081301270433\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"city\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"Bilbao\",\n          \"Madrid\",\n          \"Barcelona\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"store_size\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 14866.238240781933,\n        \"min\": 464.03549999999996,\n        \"max\": 33706.0709,\n        \"num_unique_values\": 4,\n        \"samples\": [\n          464.31419999999997,\n          464.03549999999996,\n          33706.0709\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"opening_hours\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"1:00 PM - 1:00 AM\",\n          \"9:00 AM - 9:00 PM\",\n          \"12:00 AM - 12:00 AM\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"phone_number\",\n      \"properties\": {\n        \"dtype\": \"date\",\n        \"min\": 911233124,\n        \"max\": 941096462,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          914738027,\n          911233124,\n          914598412\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"free_wifi\",\n      \"properties\": {\n        \"dtype\": \"date\",\n        \"min\": 1,\n        \"max\": 1,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"parking\",\n      \"properties\": {\n        \"dtype\": \"date\",\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"description\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"Luxurious haven where luck and indulgence converge, offering lavish rooms, vibrant nightlife, and endless gaming opportunities at the premier casino hotel.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"zip_code\",\n      \"properties\": {\n        \"dtype\": \"date\",\n        \"min\": 8000,\n        \"max\": 48000,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          48000\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"latitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1.4462541343178332,\n        \"min\": 39.6157289485356,\n        \"max\": 43.2481925725981,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          43.2481925725981\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"longitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2.5532345416443567,\n        \"min\": -3.67757104631234,\n        \"max\": 2.20645907110773,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          -2.92999179247754\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"date_opening\",\n      \"properties\": {\n        \"dtype\": \"date\",\n        \"min\": \"2018-06-14 00:00:00\",\n        \"max\": \"2020-03-28 00:00:00\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"2019-01-01 00:00:00\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3359.9402970886254,\n        \"min\": 1.0,\n        \"max\": 8451.0,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          2199.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"sales_representative_latitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1.4559681509966576,\n        \"min\": 39.597421622009,\n        \"max\": 43.2629406370866,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          43.2629406370866\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"sales_representative_longitude\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2.5745034294019513,\n        \"min\": -3.7193708247655,\n        \"max\": 2.20733580904726,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          -2.93584909508029\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"sales_representative_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 7,\n        \"min\": 10,\n        \"max\": 29,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          10\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":24}]},{"cell_type":"markdown","source":["We see that store ID = 9989 is very small and ID = 1 is very big compared to the other stores so we fill in the average of the store_size variable."],"metadata":{"id":"whlGBA8AxoUq"},"id":"whlGBA8AxoUq"},{"cell_type":"code","execution_count":25,"id":"8b4d1baf","metadata":{"id":"8b4d1baf","executionInfo":{"status":"ok","timestamp":1720537073749,"user_tz":-120,"elapsed":18,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["#Change the two extreme outliers to NaN\n","customer_info.loc[customer_info['id'] == 9989, 'store_size'] = np.nan\n","customer_info.loc[customer_info['id'] == 1, 'store_size'] = np.nan"]},{"cell_type":"code","execution_count":26,"id":"889694a8","metadata":{"id":"889694a8","executionInfo":{"status":"ok","timestamp":1720537073749,"user_tz":-120,"elapsed":17,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["# Drop all nan as store size is an important metric for our target variable, sales amount\n","customer_info.dropna(subset=['store_size'], inplace=True)"]},{"cell_type":"markdown","source":["We will bin the store size category into three different bins."],"metadata":{"id":"Zfa67i6eylo4"},"id":"Zfa67i6eylo4"},{"cell_type":"code","execution_count":27,"id":"6f88ac82","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6f88ac82","executionInfo":{"status":"ok","timestamp":1720537073749,"user_tz":-120,"elapsed":17,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"47322b6a-4e71-4c8a-d142-7291d92ee304"},"outputs":[{"output_type":"stream","name":"stdout","text":["store_size_category\n","0    6868\n","2    1432\n","1    1354\n","Name: count, dtype: int64\n"]}],"source":["# (small = 0, medium = 1, large = 2)\n","\n","customer_info['store_size_category'] = pd.cut(customer_info['store_size'], bins=3, labels=False)\n","customer_info\n","\n","\n","category_counts2 = customer_info['store_size_category'].value_counts()\n","print(category_counts2)\n"]},{"cell_type":"markdown","id":"469c55fd","metadata":{"id":"469c55fd"},"source":["#### Opening Hours"]},{"cell_type":"code","execution_count":28,"id":"4a699fd1","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4a699fd1","executionInfo":{"status":"ok","timestamp":1720537073750,"user_tz":-120,"elapsed":14,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"72fa3158-0ff8-48d6-cdbd-9bdad4f1bbc7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['11:00 PM - 6:00 AM', '1:00 PM - 1:00 AM', '11:00 AM - 11:00 PM',\n","       '6:00 AM - 11:00 PM', '12:00 AM - 12:00 AM', '1:00 PM - 2:00 AM',\n","       '10:00 AM - 10:30 PM', '9:00 AM - 9:00 PM', 'noon - midnight',\n","       '\"24/7\"'], dtype=object)"]},"metadata":{},"execution_count":28}],"source":["customer_info['opening_hours'].unique()\n"]},{"cell_type":"code","execution_count":29,"id":"04327788","metadata":{"id":"04327788","executionInfo":{"status":"ok","timestamp":1720537073750,"user_tz":-120,"elapsed":12,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["#Changing the values that are not in the same format\n","customer_info['opening_hours'] = customer_info['opening_hours'].str.replace('24/7', '12:00 AM - 12:00 PM')\n","customer_info['opening_hours'] = customer_info['opening_hours'].str.replace('noon - midnight', '12:00 PM - 12:00 AM')\n","customer_info['opening_hours'] = customer_info['opening_hours'].str.strip('\"')"]},{"cell_type":"code","execution_count":30,"id":"fc419985","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fc419985","executionInfo":{"status":"ok","timestamp":1720537074018,"user_tz":-120,"elapsed":279,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"e732f6fb-440e-4f41-d6c1-970f83105e7c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['11:00 PM - 6:00 AM', '1:00 PM - 1:00 AM', '11:00 AM - 11:00 PM',\n","       '6:00 AM - 11:00 PM', '12:00 AM - 12:00 AM', '1:00 PM - 2:00 AM',\n","       '10:00 AM - 10:30 PM', '9:00 AM - 9:00 PM', '12:00 PM - 12:00 AM',\n","       '12:00 AM - 12:00 PM'], dtype=object)"]},"metadata":{},"execution_count":30}],"source":["customer_info['opening_hours'].unique()"]},{"cell_type":"code","execution_count":31,"id":"eae9e707","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":591},"id":"eae9e707","executionInfo":{"status":"ok","timestamp":1720537074018,"user_tz":-120,"elapsed":4,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"1511c6c1-6f85-4da0-cca5-b5a0fe6ca53f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["    distance      city  store_size        opening_hours phone_number  \\\n","1  31.681670  A Coruña    122.1635   11:00 PM - 6:00 AM    943541778   \n","2  29.656813    Bilbao     71.1614    1:00 PM - 1:00 AM    957692923   \n","3  31.277988  Alicante     75.7135  11:00 AM - 11:00 PM    932749967   \n","4  38.071841    Madrid    215.2493   6:00 AM - 11:00 PM    933103025   \n","5  38.649910   Caceres    252.1306   6:00 AM - 11:00 PM    927092027   \n","\n","  free_wifi parking                                        description  \\\n","1         1       0  Warm wooden accents, rich Guinness aromas, and...   \n","2         1       1  Warmly lit, rustic tables and vintage amphorae...   \n","3         1       0  Vibrant eatery serving a medley of small plate...   \n","4         1       1  Luxurious haven where luck and indulgence conv...   \n","5         0       0  Serenely situated amidst powdery white sands a...   \n","\n","  zip_code   latitude  longitude date_opening   id  \\\n","1    15000  43.351256  -8.410301   2020-02-17  2.0   \n","2    48000  43.255756  -2.939133   2019-04-15  3.0   \n","3     3000  38.354208  -0.505718   2019-04-17  4.0   \n","4    28000  40.463496  -3.635538   2019-04-05  5.0   \n","5    10000  39.472037  -6.371697   2018-06-15  6.0   \n","\n","   sales_representative_latitude  sales_representative_longitude  \\\n","1                      43.362927                       -8.402358   \n","2                      43.262941                       -2.935849   \n","3                      38.300530                       -0.604413   \n","4                      40.453918                       -3.654711   \n","5                      39.474834                       -6.363447   \n","\n","   sales_representative_id  store_size_category opening_hour closing_hour  \n","1                       22                    0     11:00 PM      6:00 AM  \n","2                       10                    0      1:00 PM      1:00 AM  \n","3                       15                    0     11:00 AM     11:00 PM  \n","4                       29                    1      6:00 AM     11:00 PM  \n","5                        8                    1      6:00 AM     11:00 PM  "],"text/html":["\n","  <div id=\"df-8ca3ad0f-c5ef-4f2b-8039-52eff8c3ddd0\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>distance</th>\n","      <th>city</th>\n","      <th>store_size</th>\n","      <th>opening_hours</th>\n","      <th>phone_number</th>\n","      <th>free_wifi</th>\n","      <th>parking</th>\n","      <th>description</th>\n","      <th>zip_code</th>\n","      <th>latitude</th>\n","      <th>longitude</th>\n","      <th>date_opening</th>\n","      <th>id</th>\n","      <th>sales_representative_latitude</th>\n","      <th>sales_representative_longitude</th>\n","      <th>sales_representative_id</th>\n","      <th>store_size_category</th>\n","      <th>opening_hour</th>\n","      <th>closing_hour</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>31.681670</td>\n","      <td>A Coruña</td>\n","      <td>122.1635</td>\n","      <td>11:00 PM - 6:00 AM</td>\n","      <td>943541778</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Warm wooden accents, rich Guinness aromas, and...</td>\n","      <td>15000</td>\n","      <td>43.351256</td>\n","      <td>-8.410301</td>\n","      <td>2020-02-17</td>\n","      <td>2.0</td>\n","      <td>43.362927</td>\n","      <td>-8.402358</td>\n","      <td>22</td>\n","      <td>0</td>\n","      <td>11:00 PM</td>\n","      <td>6:00 AM</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>29.656813</td>\n","      <td>Bilbao</td>\n","      <td>71.1614</td>\n","      <td>1:00 PM - 1:00 AM</td>\n","      <td>957692923</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Warmly lit, rustic tables and vintage amphorae...</td>\n","      <td>48000</td>\n","      <td>43.255756</td>\n","      <td>-2.939133</td>\n","      <td>2019-04-15</td>\n","      <td>3.0</td>\n","      <td>43.262941</td>\n","      <td>-2.935849</td>\n","      <td>10</td>\n","      <td>0</td>\n","      <td>1:00 PM</td>\n","      <td>1:00 AM</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>31.277988</td>\n","      <td>Alicante</td>\n","      <td>75.7135</td>\n","      <td>11:00 AM - 11:00 PM</td>\n","      <td>932749967</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Vibrant eatery serving a medley of small plate...</td>\n","      <td>3000</td>\n","      <td>38.354208</td>\n","      <td>-0.505718</td>\n","      <td>2019-04-17</td>\n","      <td>4.0</td>\n","      <td>38.300530</td>\n","      <td>-0.604413</td>\n","      <td>15</td>\n","      <td>0</td>\n","      <td>11:00 AM</td>\n","      <td>11:00 PM</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>38.071841</td>\n","      <td>Madrid</td>\n","      <td>215.2493</td>\n","      <td>6:00 AM - 11:00 PM</td>\n","      <td>933103025</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Luxurious haven where luck and indulgence conv...</td>\n","      <td>28000</td>\n","      <td>40.463496</td>\n","      <td>-3.635538</td>\n","      <td>2019-04-05</td>\n","      <td>5.0</td>\n","      <td>40.453918</td>\n","      <td>-3.654711</td>\n","      <td>29</td>\n","      <td>1</td>\n","      <td>6:00 AM</td>\n","      <td>11:00 PM</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>38.649910</td>\n","      <td>Caceres</td>\n","      <td>252.1306</td>\n","      <td>6:00 AM - 11:00 PM</td>\n","      <td>927092027</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>Serenely situated amidst powdery white sands a...</td>\n","      <td>10000</td>\n","      <td>39.472037</td>\n","      <td>-6.371697</td>\n","      <td>2018-06-15</td>\n","      <td>6.0</td>\n","      <td>39.474834</td>\n","      <td>-6.363447</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>6:00 AM</td>\n","      <td>11:00 PM</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8ca3ad0f-c5ef-4f2b-8039-52eff8c3ddd0')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-8ca3ad0f-c5ef-4f2b-8039-52eff8c3ddd0 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-8ca3ad0f-c5ef-4f2b-8039-52eff8c3ddd0');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-416d530c-8074-432d-9e38-dc63a27b2fd8\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-416d530c-8074-432d-9e38-dc63a27b2fd8')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-416d530c-8074-432d-9e38-dc63a27b2fd8 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"customer_info","repr_error":"0"}},"metadata":{},"execution_count":31}],"source":["#Creating two new columns, for opening and closing  hours eparately\n","customer_info[['opening_hour', 'closing_hour']] = customer_info['opening_hours'].str.split(' - ', expand=True)\n","customer_info.head()\n"]},{"cell_type":"code","execution_count":32,"id":"c2486395","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":591},"id":"c2486395","executionInfo":{"status":"ok","timestamp":1720537074526,"user_tz":-120,"elapsed":511,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"93e640db-fe31-41a4-e67a-b31e426ebb15"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["    distance      city  store_size        opening_hours phone_number  \\\n","1  31.681670  A Coruña    122.1635   11:00 PM - 6:00 AM    943541778   \n","2  29.656813    Bilbao     71.1614    1:00 PM - 1:00 AM    957692923   \n","3  31.277988  Alicante     75.7135  11:00 AM - 11:00 PM    932749967   \n","4  38.071841    Madrid    215.2493   6:00 AM - 11:00 PM    933103025   \n","5  38.649910   Caceres    252.1306   6:00 AM - 11:00 PM    927092027   \n","\n","  free_wifi parking                                        description  \\\n","1         1       0  Warm wooden accents, rich Guinness aromas, and...   \n","2         1       1  Warmly lit, rustic tables and vintage amphorae...   \n","3         1       0  Vibrant eatery serving a medley of small plate...   \n","4         1       1  Luxurious haven where luck and indulgence conv...   \n","5         0       0  Serenely situated amidst powdery white sands a...   \n","\n","  zip_code   latitude  longitude date_opening   id  \\\n","1    15000  43.351256  -8.410301   2020-02-17  2.0   \n","2    48000  43.255756  -2.939133   2019-04-15  3.0   \n","3     3000  38.354208  -0.505718   2019-04-17  4.0   \n","4    28000  40.463496  -3.635538   2019-04-05  5.0   \n","5    10000  39.472037  -6.371697   2018-06-15  6.0   \n","\n","   sales_representative_latitude  sales_representative_longitude  \\\n","1                      43.362927                       -8.402358   \n","2                      43.262941                       -2.935849   \n","3                      38.300530                       -0.604413   \n","4                      40.453918                       -3.654711   \n","5                      39.474834                       -6.363447   \n","\n","   sales_representative_id  store_size_category opening_hour closing_hour  \n","1                       22                    0        23:00        06:00  \n","2                       10                    0        13:00        01:00  \n","3                       15                    0        11:00        23:00  \n","4                       29                    1        06:00        23:00  \n","5                        8                    1        06:00        23:00  "],"text/html":["\n","  <div id=\"df-274e1e88-29f6-490e-8653-3e4b71ae054c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>distance</th>\n","      <th>city</th>\n","      <th>store_size</th>\n","      <th>opening_hours</th>\n","      <th>phone_number</th>\n","      <th>free_wifi</th>\n","      <th>parking</th>\n","      <th>description</th>\n","      <th>zip_code</th>\n","      <th>latitude</th>\n","      <th>longitude</th>\n","      <th>date_opening</th>\n","      <th>id</th>\n","      <th>sales_representative_latitude</th>\n","      <th>sales_representative_longitude</th>\n","      <th>sales_representative_id</th>\n","      <th>store_size_category</th>\n","      <th>opening_hour</th>\n","      <th>closing_hour</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>31.681670</td>\n","      <td>A Coruña</td>\n","      <td>122.1635</td>\n","      <td>11:00 PM - 6:00 AM</td>\n","      <td>943541778</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Warm wooden accents, rich Guinness aromas, and...</td>\n","      <td>15000</td>\n","      <td>43.351256</td>\n","      <td>-8.410301</td>\n","      <td>2020-02-17</td>\n","      <td>2.0</td>\n","      <td>43.362927</td>\n","      <td>-8.402358</td>\n","      <td>22</td>\n","      <td>0</td>\n","      <td>23:00</td>\n","      <td>06:00</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>29.656813</td>\n","      <td>Bilbao</td>\n","      <td>71.1614</td>\n","      <td>1:00 PM - 1:00 AM</td>\n","      <td>957692923</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Warmly lit, rustic tables and vintage amphorae...</td>\n","      <td>48000</td>\n","      <td>43.255756</td>\n","      <td>-2.939133</td>\n","      <td>2019-04-15</td>\n","      <td>3.0</td>\n","      <td>43.262941</td>\n","      <td>-2.935849</td>\n","      <td>10</td>\n","      <td>0</td>\n","      <td>13:00</td>\n","      <td>01:00</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>31.277988</td>\n","      <td>Alicante</td>\n","      <td>75.7135</td>\n","      <td>11:00 AM - 11:00 PM</td>\n","      <td>932749967</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>Vibrant eatery serving a medley of small plate...</td>\n","      <td>3000</td>\n","      <td>38.354208</td>\n","      <td>-0.505718</td>\n","      <td>2019-04-17</td>\n","      <td>4.0</td>\n","      <td>38.300530</td>\n","      <td>-0.604413</td>\n","      <td>15</td>\n","      <td>0</td>\n","      <td>11:00</td>\n","      <td>23:00</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>38.071841</td>\n","      <td>Madrid</td>\n","      <td>215.2493</td>\n","      <td>6:00 AM - 11:00 PM</td>\n","      <td>933103025</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>Luxurious haven where luck and indulgence conv...</td>\n","      <td>28000</td>\n","      <td>40.463496</td>\n","      <td>-3.635538</td>\n","      <td>2019-04-05</td>\n","      <td>5.0</td>\n","      <td>40.453918</td>\n","      <td>-3.654711</td>\n","      <td>29</td>\n","      <td>1</td>\n","      <td>06:00</td>\n","      <td>23:00</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>38.649910</td>\n","      <td>Caceres</td>\n","      <td>252.1306</td>\n","      <td>6:00 AM - 11:00 PM</td>\n","      <td>927092027</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>Serenely situated amidst powdery white sands a...</td>\n","      <td>10000</td>\n","      <td>39.472037</td>\n","      <td>-6.371697</td>\n","      <td>2018-06-15</td>\n","      <td>6.0</td>\n","      <td>39.474834</td>\n","      <td>-6.363447</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>06:00</td>\n","      <td>23:00</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-274e1e88-29f6-490e-8653-3e4b71ae054c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-274e1e88-29f6-490e-8653-3e4b71ae054c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-274e1e88-29f6-490e-8653-3e4b71ae054c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-9484542c-bb3d-4daf-ac88-25573638e91a\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-9484542c-bb3d-4daf-ac88-25573638e91a')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-9484542c-bb3d-4daf-ac88-25573638e91a button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"customer_info","repr_error":"0"}},"metadata":{},"execution_count":32}],"source":["#Change the format type\n","customer_info['opening_hour'] = pd.to_datetime(customer_info['opening_hour'], format='%I:%M %p').dt.strftime('%H:%M')\n","customer_info['closing_hour'] = pd.to_datetime(customer_info['closing_hour'], format='%I:%M %p').dt.strftime('%H:%M')\n","customer_info.head()"]},{"cell_type":"markdown","id":"43f7eea3","metadata":{"id":"43f7eea3"},"source":["#### Free Wifi"]},{"cell_type":"code","execution_count":33,"id":"cbd52261","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cbd52261","executionInfo":{"status":"ok","timestamp":1720537074527,"user_tz":-120,"elapsed":11,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"6503170c-36ac-45ff-dba0-ec9031e8cb9d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 0, 'yes', -1, 'no'], dtype=object)"]},"metadata":{},"execution_count":33}],"source":["customer_info['free_wifi'].unique()\n"]},{"cell_type":"code","execution_count":34,"id":"a8796876","metadata":{"id":"a8796876","executionInfo":{"status":"ok","timestamp":1720537074527,"user_tz":-120,"elapsed":7,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["#Convert the 'free_wifi' column to boolean type\n","customer_info['free_wifi'] = customer_info['free_wifi'].astype(bool)"]},{"cell_type":"markdown","source":["#### Parking"],"metadata":{"id":"exKOZnj3p2mE"},"id":"exKOZnj3p2mE"},{"cell_type":"code","execution_count":35,"id":"05064079","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"05064079","executionInfo":{"status":"ok","timestamp":1720537074527,"user_tz":-120,"elapsed":7,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"7e216d21-b591-4126-d61f-61fc8c3452ca"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 1, 'no', 'yes', 10, -1], dtype=object)"]},"metadata":{},"execution_count":35}],"source":["customer_info['parking'].unique()"]},{"cell_type":"code","execution_count":36,"id":"11c73c06","metadata":{"id":"11c73c06","executionInfo":{"status":"ok","timestamp":1720537074527,"user_tz":-120,"elapsed":5,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}}},"outputs":[],"source":["#Convert the 'parking' column to boolean type\n","customer_info['parking'] = customer_info['parking'].astype(bool)"]},{"cell_type":"markdown","id":"eb65efd7","metadata":{"id":"eb65efd7"},"source":["#### Description"]},{"cell_type":"code","execution_count":37,"id":"5859f116","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5859f116","executionInfo":{"status":"ok","timestamp":1720537074771,"user_tz":-120,"elapsed":248,"user":{"displayName":"Marguerita Alting Von Geusau","userId":"07255363213164940583"}},"outputId":"c6e5e44e-7134-4374-bb88-34d5b48bb172"},"outputs":[{"output_type":"stream","name":"stdout","text":["Unique descriptions: 43\n","Warm wooden accents, rich Guinness aromas, and lively tunes fill the cozy atmosphere of this authentic Irish pub, a haven for weary travelers.: 132\n","Warmly lit, rustic tables and vintage amphorae adorn the cozy Greek restaurant, transporting patrons to the Mediterranean coast with every savory bite.: 344\n","Vibrant eatery serving a medley of small plates, offering a sensory journey through Spanish flavors and aromas in a warm, inviting atmosphere.: 336\n","Luxurious haven where luck and indulgence converge, offering lavish rooms, vibrant nightlife, and endless gaming opportunities at the premier casino hotel.: 255\n","Serenely situated amidst powdery white sands and crystal-clear waters, this luxurious beachfront hotel offers unparalleled oceanfront views and tranquil relaxation.: 262\n","Vibrant hub of merriment where strangers become friends, belting out tunes in a cozy atmosphere, fueled by laughter and libations.: 148\n","Lively eatery serving innovative plant-based dishes crafted with love, emphasizing sustainability and cruelty-free philosophy in a cozy, eclectic atmosphere.: 308\n","Warm golden lighting envelops the rustic wooden tables and vintage jazz records spinning softly in the background, transporting patrons to a bygone era of sophisticated revelry.: 132\n","Nice pizza, pasta and pistaccio tart, elaborated with exquisite and tailored care.: 1\n","Elegant ambiance, soft candlelight, and exquisite aromas wafting from the kitchen of this charming French restaurant.: 364\n","Warm haven where rustic charm mingles with cozy comforts, serving up craft ales and hearty pub grub amidst lively chatter and crackling fires.: 117\n","Vibrant eatery serving authentic Szechuan cuisine amidst ornate dragons and red lanterns amidst lively chatter.: 357\n","Rich aromas of grilled meats waft through the rustic-chic atmosphere of this upscale steakhouse restaurant, serving premium cuts of tender, juicy steak.: 359\n","Warm ambiance wraps around you like a cozy blanket as you step into this charming Italian restaurant, where aromas of freshly baked bread and simmering sauces fill the air.: 349\n","Luxurious retreat nestled amidst lush greenery, offering lavish rooms, fine dining, and rejuvenating spa treatments within a tranquil resort hotel setting.: 277\n","A cozy, rustic haven serving farm-to-table fare and craft brews in a warm, inviting atmosphere.: 116\n","Intimate oasis blending luxurious comforts with eclectic charm, boutique hotel whispers sweet nothings to weary travelers seeking unique retreat.: 294\n","Warm aromas of lemongrass and galangal waft through the doors of this cozy Thai restaurant, where vibrant colors and intricate carvings transport diners to the bustling streets of Bangkok.: 334\n","A vibrant gathering spot where friends and fans unite, surrounded by lively chatter, frosty pints, and the thrill of live sports broadcasts.: 130\n","Warm and inviting, rustic charm abounds in this cozy country pub, where hearty meals and pints await amidst vintage decor and crackling fires.: 147\n","A futuristic eatery where East meets West, flavors blend harmoniously, and the senses come alive in a culinary symphony of taste and aroma.: 343\n","A cozy retreat for furry friends and their owners, featuring plush accommodations, a serene courtyard, and a welcoming atmosphere.: 304\n","Expensive Japansese food with fushion plates and delicous aromas: 1\n","Vibrant tapas bar serving authentic paella and empanadas in a cozy, rustic-chic setting with warm aromas of olive oil and saffron.: 347\n","Vibrant hues of turquoise and red adorn the exterior of this lively Mexican restaurant, enticing passersby with aromas of sizzling fajitas and savory carne asada.: 334\n","Warm lighting illuminates the cozy atmosphere of the Japanese restaurant, where subtle aromas of soy sauce and sesame oil mingle with the soft hum of conversation.: 358\n","Tiny, futuristic sanctuaries offering luxurious solitude amidst bustling cities, providing an intimate retreat for weary travelers.: 276\n","Sleek urban oasis offering luxurious apartments and personalized service, blending modern comfort with boutique hotel charm in the heart of the city.: 300\n","Warm terracotta hues and rustic wooden accents adorn the walls of this Mediterranean restaurant, transporting patrons to the sun-kissed shores of the Mediterranean Sea.: 351\n","A no-frills haven offering cozy rooms at an affordable price, perfect for the thrifty traveler seeking a comfortable night's rest.: 284\n","Luxurious oasis retreat offering serene ambiance, rejuvenating treatments, and tranquil surroundings within a boutique spa hotel.: 306\n","A chic oasis in the city's heart, this urban hotel combines sleek design with luxurious comfort, offering a tranquil retreat from the bustling metropolis.: 288\n","Vibrant eatery serving aromatic curries, fluffy basmati rice, and crispy naan bread in a warm, welcoming atmosphere evoking the flavors of India.: 308\n","Cozy gathering spot where beer enthusiasts unite, surrounded by rustic charm, warm lighting, and the intoxicating aromas of expertly crafted brews.: 125\n","A sumptuous retreat of opulence, where lavish decor and impeccable service converge, amidst tranquil surroundings, redefining luxury hotel excellence.: 286\n","Sustainable retreat blending harmoniously with nature's rhythms, offering luxurious comforts and eco-friendly amenities within a tranquil, serene ambiance.: 263\n","Vibrant dive pub radiates warmth, walls adorned with eclectic trinkets, neon lights flashing amidst laughter and whiskey-infused conversations.: 130\n","A lively gathering spot where craft beers and expertly mixed cocktails flow freely amidst warm ambiance and lively chatter.: 144\n","Warm and inviting, this theme pub transports patrons to a bygone era with vintage decor, lively atmosphere, and a menu of classic pub fare.: 140\n","I hated this place so much is unreal, nasty pasta and worse pizza deg!: 1\n","They call this a cozy retreat to stay, but I feel beds are unconfortable and it is full of bugs.: 1\n","Warm lighting illuminates the atmosphere of the Japanese restaurant, where subtle aromas of soy sauce and sesame oil mingle with the soft hum of conversation.: 1\n","Warm terracotta hues and rustic wooden accents adorn the walls of this Mediterranean restaurant.: 1\n"]}],"source":["#Getting insights on the uniqueness and count of the descriptions\n","print(\"Unique descriptions:\", customer_info['description'].nunique())\n","unique_values = customer_info['description'].unique()\n","for value in unique_values:\n","    count = len(customer_info[customer_info['description'] == value])\n","    print(f\"{value}: {count}\")"]},{"cell_type":"markdown","source":["\n","Since we only had 43 unique descriptions, and to save time, we decided to group the descriptions into 4 different categories to gain better insights."],"metadata":{"id":"KXMH7cvZ_r7t"},"id":"KXMH7cvZ_r7t"},{"cell_type":"code","execution_count":null,"id":"8cc5da25","metadata":{"id":"8cc5da25"},"outputs":[],"source":["#To make sense of the reviews we created a new dataset that devides the review into 3 main categories\n","customer_info_description = pd.read_excel(data_path + '/customer_info_description.xlsx')\n","customer_info_description.head(20)\n"]},{"cell_type":"markdown","source":["Merge the customer category dataset with the customer info dataset."],"metadata":{"id":"SGETQHzK6b0u"},"id":"SGETQHzK6b0u"},{"cell_type":"code","execution_count":null,"id":"9f04b2e9","metadata":{"id":"9f04b2e9"},"outputs":[],"source":["customer_info_description.columns = customer_info_description.columns.str.strip().str.lower().str.replace(' ', '_').str.replace(r'\\W', '_')\n","\n","customer_info = pd.merge(customer_info, customer_info_description, on='description', how='left')\n","customer_info.head()"]},{"cell_type":"code","source":["customer_info['customer_category'].unique()"],"metadata":{"id":"SGsXs4-u7ye2"},"id":"SGsXs4-u7ye2","execution_count":null,"outputs":[]},{"cell_type":"markdown","id":"98336029","metadata":{"id":"98336029"},"source":["#### Zip code"]},{"cell_type":"code","execution_count":null,"id":"f0ec3be2","metadata":{"id":"f0ec3be2"},"outputs":[],"source":["#In case zip codes contain letters or a zero at the beginning, we cannot convert them to numeric\n","#Non correct zip_zodes will be converted to NaN\n","customer_info['zip_code'] = customer_info['zip_code'].replace('-', np.nan)\n"]},{"cell_type":"code","execution_count":null,"id":"33de8adc","metadata":{"id":"33de8adc"},"outputs":[],"source":["customer_info[customer_info['zip_code'].isna()]\n"]},{"cell_type":"code","execution_count":null,"id":"7e2a4c74","metadata":{"id":"7e2a4c74"},"outputs":[],"source":["#Fill in the NaN with the zip code of the belonging city\n","for city in customer_info['city'].unique():\n","    mode_zip_code = customer_info.loc[customer_info['city'] == city, 'zip_code'].mode()[0]\n","    customer_info.loc[(customer_info['city'] == city) & (customer_info['zip_code'].isna()), 'zip_code'] = mode_zip_code\n"]},{"cell_type":"markdown","id":"cb5a3c87","metadata":{"id":"cb5a3c87"},"source":["#### Date opening"]},{"cell_type":"code","execution_count":null,"id":"79c0dbb8","metadata":{"id":"79c0dbb8"},"outputs":[],"source":["#Convert the 'date_opening' column to datetime format\n","customer_info['date_opening'] = pd.to_datetime(customer_info['date_opening'])"]},{"cell_type":"markdown","id":"88024745","metadata":{"id":"88024745"},"source":["#### ID"]},{"cell_type":"code","execution_count":null,"id":"46b9a6c9","metadata":{"id":"46b9a6c9"},"outputs":[],"source":["customer_info[customer_info['id'].isna()]"]},{"cell_type":"code","execution_count":null,"id":"e9255620","metadata":{"id":"e9255620"},"outputs":[],"source":["#ID's cannot be filled in based on other assumptions\n","customer_info.dropna(subset=['id'], inplace=True)"]},{"cell_type":"code","execution_count":null,"id":"0fbe1341","metadata":{"id":"0fbe1341"},"outputs":[],"source":["#For consistency we change -1 to 0\n","customer_info['id'].replace(-1, 0, inplace=True)"]},{"cell_type":"code","execution_count":null,"id":"aa2506ad","metadata":{"id":"aa2506ad"},"outputs":[],"source":["customer_info[customer_info['id'].isin([0, -1])]"]},{"cell_type":"markdown","id":"f1742e5f","metadata":{"id":"f1742e5f"},"source":["#### sales_representative_latitude, sales_representative_longitude, sales_representative_id"]},{"cell_type":"code","execution_count":null,"id":"3e95de77","metadata":{"id":"3e95de77"},"outputs":[],"source":["#To make sense of the sales representatives latitude and longtitude, we will calculate the distance between the sales representative and the store\n","def haversine_distance(lat1, lon1, lat2, lon2):\n","    lat1_rad, lon1_rad, lat2_rad, lon2_rad = map(math.radians, [lat1, lon1, lat2, lon2]) #from latitude/longtitude to radians\n","\n","    dlon = lon2_rad - lon1_rad\n","    dlat = lat2_rad - lat1_rad\n","    a = math.sin(dlat/2)**2 + math.cos(lat1_rad) * math.cos(lat2_rad) * math.sin(dlon/2)**2\n","    c = 2 * math.asin(math.sqrt(a))\n","\n","    R = 6371 #Radius of the earth\n","\n","    distance = R * c\n","\n","    return round(distance, 2)\n","\n","distances = []\n","for index, row in customer_info.iterrows():\n","    distance = haversine_distance(row['latitude'], row['longitude'], row['sales_representative_latitude'], row['sales_representative_longitude'])\n","    distances.append(distance)\n","\n","customer_info['distance_rep_cust_km'] = distances"]},{"cell_type":"code","execution_count":null,"id":"98828ffb","metadata":{"id":"98828ffb"},"outputs":[],"source":["customer_info.sort_values(by='distance_rep_cust_km', ascending=False).head(8)[['latitude', 'longitude', 'sales_representative_latitude', 'sales_representative_longitude', 'distance_rep_cust_km', 'sales_representative_id', 'id']]\n","# assuming either the coordinations of the store or sales person are incorrect for sales ID 6420, 5439, 5996, 21, 14, 4903, 5193\n"]},{"cell_type":"markdown","source":["For the sales ID 5439, 5996, 14, 4903 and 5193 we switch latitude and longtitude as we saw that by switching they belong to the right city."],"metadata":{"id":"IxgNLTp_CEQS"},"id":"IxgNLTp_CEQS"},{"cell_type":"code","execution_count":null,"id":"7c29f7cd","metadata":{"id":"7c29f7cd"},"outputs":[],"source":["id_to_switch = [5439, 5996, 14, 4903, 5193]\n","customer_info.loc[customer_info['id'].isin(id_to_switch), ['latitude', 'longitude']] = \\\n","customer_info.loc[customer_info['id'].isin(id_to_switch), ['longitude', 'latitude']].values\n","#customer_info.loc[rows_to_switch, ['latitude', 'longitude']] = customer_info.loc[rows_to_switch, ['longitude', 'latitude']].values\n","customer_info.sort_values(by='distance_rep_cust_km', ascending=False).head(8)[['latitude', 'longitude', 'sales_representative_latitude', 'sales_representative_longitude', 'distance_rep_cust_km']]\n","\n","def haversine_distance(lat1, lon1, lat2, lon2):\n","    lat1_rad, lon1_rad, lat2_rad, lon2_rad = map(math.radians, [lat1, lon1, lat2, lon2])\n","\n","    dlon = lon2_rad - lon1_rad\n","    dlat = lat2_rad - lat1_rad\n","    a = math.sin(dlat/2)**2 + math.cos(lat1_rad) * math.cos(lat2_rad) * math.sin(dlon/2)**2\n","    c = 2 * math.asin(math.sqrt(a))\n","\n","    R = 6371\n","\n","    distance = R * c\n","\n","    return round(distance, 2)\n","\n","distances = []\n","for index, row in customer_info.iterrows():\n","    distance = haversine_distance(row['latitude'], row['longitude'], row['sales_representative_latitude'], row['sales_representative_longitude'])\n","    distances.append(distance)\n","\n","customer_info['distance_rep_cust_km'] = distances\n","\n","customer_info.sort_values(by='distance_rep_cust_km', ascending=False).head(9)[['id','sales_representative_id','latitude', 'longitude', 'sales_representative_latitude', 'sales_representative_longitude', 'distance_rep_cust_km']]"]},{"cell_type":"markdown","source":["We noticed that the latitude and longitude for store ID 21 are not in Spain, even if we swap them. Given the importance of these features for our analysis, we have decided to remove store ID 21 from the dataset."],"metadata":{"id":"zgpjUHrvShI_"},"id":"zgpjUHrvShI_"},{"cell_type":"code","source":["#Drop the row with store ID 21\n","customer_info = customer_info[customer_info['id'] != 21]"],"metadata":{"id":"cIcPTDqHSgxb"},"id":"cIcPTDqHSgxb","execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["We observed that the latitude and longitude for sales_representative_id 27 are not in Spain. Therefore, we replaced these values with the most common latitude and longitude in our dataset."],"metadata":{"id":"a4Xmv6p4FK1W"},"id":"a4Xmv6p4FK1W"},{"cell_type":"code","execution_count":null,"id":"bbda3ef9","metadata":{"id":"bbda3ef9"},"outputs":[],"source":["#for sales_rep_ id 27 --> lat and long knows (mode)\n","#Find the mode latitude and longitude for sales_representative_id 27\n","mode_latitude_27 = customer_info[customer_info['sales_representative_id'] == 27]['sales_representative_latitude'].mode()[0]\n","mode_longitude_27 = customer_info[customer_info['sales_representative_id'] == 27]['sales_representative_longitude'].mode()[0]\n","\n","#Update the latitude and longitude for sales_representative_id 27 with the mode latitude and longitude\n","customer_info.loc[customer_info['sales_representative_id'] == 27, 'sales_representative_latitude'] = mode_latitude_27\n","customer_info.loc[customer_info['sales_representative_id'] == 27, 'sales_representative_longitude'] = mode_longitude_27\n"]},{"cell_type":"code","execution_count":null,"id":"e5366792","metadata":{"id":"e5366792"},"outputs":[],"source":["def haversine_distance(lat1, lon1, lat2, lon2):\n","    lat1_rad, lon1_rad, lat2_rad, lon2_rad = map(math.radians, [lat1, lon1, lat2, lon2])\n","\n","    dlon = lon2_rad - lon1_rad\n","    dlat = lat2_rad - lat1_rad\n","    a = math.sin(dlat/2)**2 + math.cos(lat1_rad) * math.cos(lat2_rad) * math.sin(dlon/2)**2\n","    c = 2 * math.asin(math.sqrt(a))\n","\n","    R = 6371\n","\n","    distance = R * c\n","\n","    return round(distance, 2)\n","\n","distances = []\n","for index, row in customer_info.iterrows():\n","    distance = haversine_distance(row['latitude'], row['longitude'], row['sales_representative_latitude'], row['sales_representative_longitude'])\n","    distances.append(distance)\n","\n","customer_info['distance_rep_cust_km'] = distances\n","\n","customer_info.sort_values(by='distance_rep_cust_km', ascending=False).head(20)[['id','sales_representative_id','latitude', 'longitude', 'sales_representative_latitude', 'sales_representative_longitude', 'distance_rep_cust_km']]"]},{"cell_type":"code","execution_count":null,"id":"573a86a4","metadata":{"id":"573a86a4"},"outputs":[],"source":["customer_info.sort_values(by='distance_rep_cust_km', ascending=False).head(10)[['id','latitude', 'longitude', 'sales_representative_latitude', 'sales_representative_longitude', 'distance_rep_cust_km','sales_representative_id']]"]},{"cell_type":"code","execution_count":null,"id":"41077ff5","metadata":{"id":"41077ff5"},"outputs":[],"source":["customer_info['sales_representative_id'] = customer_info['sales_representative_id'].astype(str)\n","customer_info['id'] = customer_info['id'].astype(str)"]},{"cell_type":"code","execution_count":null,"id":"294770c2","metadata":{"id":"294770c2"},"outputs":[],"source":["customer_info.head()"]},{"cell_type":"code","execution_count":null,"id":"5a4a0b2d","metadata":{"id":"5a4a0b2d"},"outputs":[],"source":["customer_info.dtypes"]},{"cell_type":"markdown","id":"d36ddb99","metadata":{"id":"d36ddb99"},"source":["### Save the dataset to a new version containing the cleaned data set with all the columns"]},{"cell_type":"code","execution_count":null,"id":"a4a9461c","metadata":{"id":"a4a9461c"},"outputs":[],"source":["customer_info.to_csv(\"customer_info_V2.csv\", index=False)"]},{"cell_type":"markdown","id":"ebac41ca","metadata":{"id":"ebac41ca"},"source":["## Dropping all the columns that are not relevant"]},{"cell_type":"code","execution_count":null,"id":"3b6b2126","metadata":{"id":"3b6b2126"},"outputs":[],"source":["customer_info_v2 = pd.read_csv('customer_info_V2.csv')\n","\n","customer_info_v2.head()"]},{"cell_type":"code","execution_count":null,"id":"e4f0d05c","metadata":{"id":"e4f0d05c"},"outputs":[],"source":["#Delete all not needed columns:\n","#geographic locations still needed for visualisation\n","customer_info_v2 = customer_info_v2.drop(\n","    columns =[\n","    'opening_hours', #split into opening_hour and closing_hour\n","    'phone_number', #not relevant for the business case\n","    'description', #Split into category columns\n","    'zip_code' #Zip_code is connected to City and for futher analyses we will use city only\n","])\n","\n","customer_info_v2.head()"]},{"cell_type":"markdown","id":"bee455d6","metadata":{"id":"bee455d6"},"source":["# Save as a clean data set"]},{"cell_type":"code","source":["output_dir = '/content/drive/Shared drives/Deloitte/Cleaned Data'\n","customer_info_v2.to_csv(output_dir + '/customer_info_cleaned.csv', index=False)\n"],"metadata":{"id":"1Kk22qWTt81b"},"id":"1Kk22qWTt81b","execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"id":"63cd8467","metadata":{"id":"63cd8467"},"outputs":[],"source":[]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.4"},"colab":{"provenance":[]}},"nbformat":4,"nbformat_minor":5}